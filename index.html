<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Carrusel 3D - Prueba</title>

  <style>
    /* Variables */
    :root{
      --primary-black:#0a0a0a;
      --carbon-dark:#121212;
      --carbon-medium:#1a1a1a;
      --metal-dark:#3a3a3a;
      --accent-red:#ff3333;
      --accent-blue:#00a8ff;
      --accent-green:#00ff88;
      --accent-purple:#9945ff;
      --accent-cyan:#00ffff;
      --text-primary:#ffffff;
      --text-secondary:#b0b0b0;
    }

    /* Reset básico */
    *{box-sizing:border-box;margin:0;padding:0}
    html{scroll-behavior:smooth}
    body{
      font-family: Inter, "Rajdhani", "Orbitron", sans-serif;
      background: var(--primary-black);
      color:var(--text-primary);
      overflow-x:hidden;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding-top:80px;
    }

    /* Header simple */
    .header{
      position:fixed;
      top:0;left:0;right:0;
      height:72px;
      display:flex;
      align-items:center;
      background: linear-gradient(180deg, rgba(18,18,18,0.98), rgba(18,18,18,0.9));
      padding:0 24px;
      z-index:2000;
      border-bottom:1px solid rgba(255,255,255,0.04);
    }
    .logo{
      color:var(--text-primary);
      font-weight:700;
      letter-spacing:1px;
      text-transform:uppercase;
    }

    /* Hero / Carrusel */
    .hero{
      min-height:calc(100vh - 72px);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:60px 20px;
      background: radial-gradient(ellipse at center, rgba(153,69,255,0.06) 0%, transparent 50%);
    }

    .carousel-container{
      width:100%;
      max-width:1400px;
      height:640px;
      perspective:1200px;
      position:relative;
      padding-top:20px;
    }

    .carousel{
      width:100%;
      height:100%;
      position:relative;
      transform-style:preserve-3d;
    }

    .carousel-item{
      position:absolute;
      width:380px;
      height:500px;
      left:50%;
      top:50%;
      transform-style:preserve-3d;
      transition: all 0.8s cubic-bezier(0.4,0,0.2,1);
      cursor:pointer;
      transform-origin:center center;
      will-change: transform, opacity;
    }

    .card{
      width:100%;
      height:100%;
      background: linear-gradient(135deg, var(--carbon-medium), var(--carbon-dark));
      border:2px solid var(--metal-dark);
      border-radius:20px;
      padding:26px;
      overflow:hidden;
      box-shadow: 0 20px 40px rgba(0,0,0,0.75), inset 0 1px 0 rgba(255,255,255,0.03);
      display:flex;
      flex-direction:column;
    }

    .card-number{
      position:absolute;
      top:18px;
      right:22px;
      font-size:64px;
      font-weight:900;
      color: rgba(153,69,255,0.08);
      font-family: 'Orbitron', monospace;
      pointer-events:none;
    }

    .card-image{
      width:100%;
      height:220px;
      border-radius:10px;
      overflow:hidden;
      margin-bottom:18px;
      border:1px solid rgba(255,255,255,0.02);
      background:var(--carbon-dark);
    }
    .card-image img{
      width:100%;
      height:100%;
      object-fit:cover;
      filter:grayscale(50%) contrast(1.15);
      transition: transform .5s ease, filter .45s ease;
      display:block;
    }
    .carousel-item:hover .card-image img{
      transform:scale(1.08);
      filter:grayscale(0%) contrast(1.2);
    }

    .card-title{
      font-size:20px;
      font-weight:800;
      text-transform:uppercase;
      letter-spacing:1px;
      margin-bottom:8px;
      background:linear-gradient(135deg, var(--text-primary), var(--accent-purple));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
    }
    .card-description{
      color:var(--text-secondary);
      font-size:14px;
      line-height:1.6;
      flex-grow:1;
    }

    .card-tech{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:12px;
    }
    .tech-badge{
      padding:6px 12px;
      font-size:12px;
      border-radius:999px;
      background: rgba(153,69,255,0.08);
      border:1px solid rgba(153,69,255,0.18);
      color:var(--accent-purple);
      text-transform:uppercase;
      letter-spacing:1px;
    }

    .card-cta{
      margin-top:14px;
      padding:10px 22px;
      border-radius:28px;
      border:none;
      cursor:pointer;
      font-weight:700;
      text-transform:uppercase;
      letter-spacing:1px;
      background: linear-gradient(135deg, var(--accent-purple), var(--accent-blue));
      color:#fff;
      box-shadow: 0 6px 18px rgba(153,69,255,0.22);
    }
    .card-cta:hover{ transform: translateY(-3px) }

    /* Controls & Indicators */
    .carousel-controls{
      position:absolute;
      bottom:-72px;
      left:50%;
      transform:translateX(-50%);
      display:flex;
      gap:18px;
      z-index:1200;
    }
    .carousel-btn{
      width:60px;height:60px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;
      background: linear-gradient(135deg, var(--carbon-medium), var(--carbon-dark));
      border:2px solid var(--metal-dark);
      color:var(--accent-purple);
      font-size:26px;
      cursor:pointer;
      transition: transform .2s ease, box-shadow .2s;
    }
    .carousel-btn:hover{ transform:scale(1.06); box-shadow:0 10px 30px rgba(153,69,255,0.12) }

    .carousel-indicators{
      position:absolute;
      top:24px;
      left:50%;
      transform:translateX(-50%);
      display:flex;gap:12px;z-index:1200;
    }
    .indicator{
      width:12px;height:12px;border-radius:50%;
      background:rgba(60,60,60,1);border:1px solid rgba(120,120,120,0.2);
      cursor:pointer;transition:all .25s;
    }
    .indicator.active{
      background: linear-gradient(135deg,var(--accent-purple),var(--accent-blue));
      transform:scale(1.35);
      box-shadow:0 0 14px rgba(153,69,255,0.35);
    }

    /* Responsive tweaks */
    @media (max-width: 900px){
      .carousel-item{ width:320px; height:430px }
      .card-image{ height:180px }
    }
    @media (max-width: 520px){
      .carousel-item{ width:280px; height:380px }
      .carousel-controls{ bottom:-86px }
    }

    /* Solid black about section (user requested 'todo de negro') */
    .philosophy-section{
      padding:80px 20px;
      background: #000; /* negro sólido, sin transparencia */
      color:var(--text-primary);
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="logo">ESCALAR CHAT</div>
  </header>

  <!-- Hero / Carrusel -->
  <main>
    <section class="hero" id="home">
      <div class="carousel-container">
        <div class="carousel" id="carousel"></div>

        <div class="carousel-controls">
          <button class="carousel-btn" id="prevBtn" aria-label="Anterior">‹</button>
          <button class="carousel-btn" id="nextBtn" aria-label="Siguiente">›</button>
        </div>

        <div class="carousel-indicators" id="indicators"></div>
      </div>
    </section>

    <!-- Ejemplo de sección negra (philosophy) -->
    <section class="philosophy-section" id="about">
      <div style="max-width:1000px;margin:0 auto;text-align:center;">
        <h2 style="font-size:36px;margin-bottom:12px">Refractando Ideas</h2>
        <p style="color:var(--text-secondary)">Sección ejemplo con fondo totalmente negro para evitar transparencias.</p>
      </div>
    </section>
  </main>

  <script>
    /* ====== Datos del portfolio (usa los nombres EXACTOS de tus imágenes en /images) ====== */
    const portfolioData = [
      { id:1, title:'Matriz IoT', description:'Ecosistema IoT inteligente conectando millones de dispositivos.', image:'images/iot-matrix.jpg', tech:['MQTT','Edge AI','5G'] },
      { id:2, title:'Interfaz AR', description:'Realidad aumentada para experiencias interactivas e inmersivas.', image:'images/ar-interface.jpg', tech:['Unity','ARCore','Visión Comp.'] },
      { id:3, title:'Nexo de Datos', description:'Plataforma de procesamiento de big data en tiempo real.', image:'images/data-nexus.jpg', tech:['Spark','Hadoop','Kafka'] },
      { id:4, title:'Defensa Cibernética', description:'Detección de amenazas en tiempo real y respuesta automatizada.', image:'images/cyber-defense.jpg', tech:['Zero Trust','SIEM'] },
      { id:5, title:'Bóveda Blockchain', description:'Almacenamiento descentralizado seguro.', image:'images/blockchain-vault.jpg', tech:['Ethereum','Web3'] },
      { id:6, title:'Nube Cuántica', description:'Computación cuántica en la nube para cargas críticas.', image:'images/quantum-cloud.jpg', tech:['Kubernetes','GPU'] },
      { id:7, title:'Red Neuronal', description:'IA avanzada para análisis predictivo y reconocimiento de patrones.', image:'images/neural-network.jpg', tech:['TensorFlow','Python'] }
    ];

    /* ====== Inicialización tras carga del DOM ====== */
    document.addEventListener('DOMContentLoaded', () => {
      const carousel = document.getElementById('carousel');
      const indicatorsContainer = document.getElementById('indicators');
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');

      let currentIndex = 0;
      let autoRotateId = null;

      function createCarouselItem(data, index){
        const item = document.createElement('div');
        item.className = 'carousel-item';
        item.dataset.index = index;

        const techBadges = (data.tech || []).map(t => `<span class="tech-badge">${t}</span>`).join('');
        const number = data.id < 10 ? '0' + data.id : data.id;

        item.innerHTML = `
          <div class="card">
            <div class="card-number">${number}</div>
            <div class="card-image"><img src="${data.image}" alt="${data.title}"></div>
            <h3 class="card-title">${data.title}</h3>
            <p class="card-description">${data.description}</p>
            <div class="card-tech">${techBadges}</div>
            <button class="card-cta" type="button">Explorar</button>
          </div>
        `;
        // Evita clicks rotos si imagen no existe — muestra consola para debug
        const img = item.querySelector('img');
        img.addEventListener('error', () => {
          console.warn('Imagen no encontrada:', data.image, '. Asegúrate que exista en /images/');
          img.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="600" height="400"><rect width="100%" height="100%" fill="#1a1a1a"/><text x="50%" y="50%" fill="#888" font-size="20" text-anchor="middle" dominant-baseline="middle">Imagen no encontrada</text></svg>';
        });

        return item;
      }

      function initCarousel(){
        // limpiar
        carousel.innerHTML = '';
        indicatorsContainer.innerHTML = '';

        portfolioData.forEach((p, i) => {
          const node = createCarouselItem(p,i);
          carousel.appendChild(node);

          const ind = document.createElement('div');
          ind.className = 'indicator' + (i === 0 ? ' active' : '');
          ind.dataset.index = i;
          ind.addEventListener('click', () => goToSlide(i));
          indicatorsContainer.appendChild(ind);
        });

        updateCarousel();
        startAutoRotate();
      }

      function computeSpacing(){
        const w = window.innerWidth;
        if (w <= 520) return {s1:260,s2:420,s3:520};
        if (w <= 900) return {s1:320,s2:520,s3:640};
        return {s1:400,s2:600,s3:750};
      }

      function updateCarousel(){
        const items = carousel.querySelectorAll('.carousel-item');
        const total = items.length;
        const {s1,s2,s3} = computeSpacing();

        items.forEach((item, idx) => {
          let offset = idx - currentIndex;

          if (offset > total/2) offset -= total;
          if (offset < -total/2) offset += total;

          const absOffset = Math.abs(offset);
          const sign = offset < 0 ? -1 : 1;

          // default
          item.style.transition = 'all 0.8s cubic-bezier(0.4,0,0.2,1)';
          item.style.opacity = '';
          item.style.zIndex = '';

          if (absOffset === 0){
            item.style.transform = 'translate(-50%,-50%) translateZ(0) scale(1)';
            item.style.opacity = '1';
            item.style.zIndex = '10';
          } else if (absOffset === 1){
            const tx = sign * s1;
            const rot = 30 * sign;
            const scale = 0.85;
            item.style.transform = `translate(-50%,-50%) translateX(${tx}px) translateZ(-200px) rotateY(${-rot}deg) scale(${scale})`;
            item.style.opacity = '0.85';
            item.style.zIndex = '6';
          } else if (absOffset === 2){
            const tx = sign * s2;
            const rot = 40 * sign;
            const scale = 0.7;
            item.style.transform = `translate(-50%,-50%) translateX(${tx}px) translateZ(-350px) rotateY(${-rot}deg) scale(${scale})`;
            item.style.opacity = '0.5';
            item.style.zIndex = '4';
          } else if (absOffset === 3){
            const tx = sign * s3;
            const rot = 45 * sign;
            const scale = 0.6;
            item.style.transform = `translate(-50%,-50%) translateX(${tx}px) translateZ(-450px) rotateY(${-rot}deg) scale(${scale})`;
            item.style.opacity = '0.25';
            item.style.zIndex = '2';
          } else {
            item.style.transform = 'translate(-50%,-50%) translateZ(-600px) scale(0.45)';
            item.style.opacity = '0';
            item.style.zIndex = '1';
          }
        });

        // indicators
        const dots = indicatorsContainer.querySelectorAll('.indicator');
        dots.forEach((d,i) => d.classList.toggle('active', i === currentIndex));
      }

      function nextSlide(){
        currentIndex = (currentIndex + 1) % portfolioData.length;
        updateCarousel();
      }

      function prevSlide(){
        currentIndex = (currentIndex - 1 + portfolioData.length) % portfolioData.length;
        updateCarousel();
      }

      function goToSlide(i){
        currentIndex = i;
        updateCarousel();
      }

      // auto rotate
      function startAutoRotate(){
        stopAutoRotate();
        autoRotateId = setInterval(nextSlide, 5000);
      }
      function stopAutoRotate(){
        if (autoRotateId) { clearInterval(autoRotateId); autoRotateId = null; }
      }

      // eventos UI
      nextBtn.addEventListener('click', () => { nextSlide(); startAutoRotate(); });
      prevBtn.addEventListener('click', () => { prevSlide(); startAutoRotate(); });

      // teclado
      document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowLeft') prevSlide();
        if (e.key === 'ArrowRight') nextSlide();
      });

      // pausa auto-rotate al pasar mouse sobre carousel
      carousel.addEventListener('mouseenter', stopAutoRotate);
      carousel.addEventListener('mouseleave', startAutoRotate);

      // resize recalcula posiciones
      let resizeTimer = null;
      window.addEventListener('resize', () => {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => updateCarousel(), 180);
      });

      // iniciar
      initCarousel();
    });
  </script>
</body>
</html>
